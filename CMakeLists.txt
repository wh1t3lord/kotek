cmake_minimum_required(VERSION 3.19.3)
project(kotek.engine)

message("[Engine]: build type is '${CMAKE_BUILD_TYPE}'")

set(KOTEK_FILENAME_FOR_GENERATING_PREPROCESSORS ./include/kotek_std_preprocessors.h)

message("[Engine]: filename for generating preprocessors: '${KOTEK_FILENAME_FOR_GENERATING_PREPROCESSORS}'")

if (WIN32)
	if (NOT ${CMAKE_SYSTEM_VERSION} EQUAL 10.0.22000)
		if ("${KOTEK_DEPS_FOLDER}" STREQUAL "")
			message("[Engine]: you can't use kotek-engine-deps-win32 because you are on Windows 10")
			set(KOTEK_DEPS_FOLDER "kotek-engine-deps-win32-vs19")
		endif()
	else()
		if ("${KOTEK_DEPS_FOLDER}" STREQUAL "")
			set(KOTEK_DEPS_FOLDER "kotek-engine-deps-win32")
		endif()
	endif()

	if (EXISTS "${PROJECT_SOURCE_DIR}/${KOTEK_DEPS_FOLDER}")
		message("[Engine] deps folder: ${KOTEK_DEPS_FOLDER}")
	else()
		message(FATAL_ERROR "[Engine]: can't obtain dependency folder ${KOTEK_DEPS_FOLDER}. You must download the folder from repository gitlab.com/wh1t3lord/${KOTEK_DEPS_FOLDER} and place it in kotek folder in your root catalogue. Otherwise you can use vcpkg and specify folder where is your packages are located.")
	endif()	
endif()

include_directories("engine")


add_subdirectory("engine/kotek.core.defines")
add_subdirectory("engine/kotek.core.defines.static")
add_subdirectory("engine/kotek.core.defines.static.cpp")
add_subdirectory("engine/kotek.core.defines.static.git")
add_subdirectory("engine/kotek.core.defines.static.render")
add_subdirectory("engine/kotek.core.defines.static.render.dx")
add_subdirectory("engine/kotek.core.defines.static.render.gl")
add_subdirectory("engine/kotek.core.defines.static.render.vk")
add_subdirectory("engine/kotek.core.defines.static.math")
add_subdirectory("engine/kotek.core.defines.static.os")
add_subdirectory("engine/kotek.core.defines.static.os.win32")
add_subdirectory("engine/kotek.core.defines.static.os.linux")
add_subdirectory("engine/kotek.core.defines.static.profilers")
add_subdirectory("engine/kotek.core.defines.static.sdk")
add_subdirectory("engine/kotek.core.defines.static.string")
add_subdirectory("engine/kotek.core.defines.static.tests")
add_subdirectory("engine/kotek.core.defines_dependent")
add_subdirectory("engine/kotek.core.defines_dependent.text")
add_subdirectory("engine/kotek.core.defines_dependent.message")
add_subdirectory("engine/kotek.core.defines_dependent.assert")
add_subdirectory("engine/kotek.core.defines_dependent.ecs")
add_subdirectory("engine/kotek.core")
add_subdirectory("engine/kotek.core.api")
add_subdirectory("engine/kotek.core.types")
add_subdirectory("engine/kotek.core.types.char")
add_subdirectory("engine/kotek.core.types.numerics")
add_subdirectory("engine/kotek.core.types.string")
add_subdirectory("engine/kotek.core.casting")
add_subdirectory("engine/kotek.core.casting.lexical")
add_subdirectory("engine/kotek.core.casting.string")
add_subdirectory("engine/kotek.core.constants")
add_subdirectory("engine/kotek.core.constants.math")
add_subdirectory("engine/kotek.core.constants.ecs")
add_subdirectory("engine/kotek.core.constants.string")
add_subdirectory("engine/kotek.core.constants.window")
add_subdirectory("engine/kotek.core.containers")
add_subdirectory("engine/kotek.core.containers.any")
add_subdirectory("engine/kotek.core.containers.array")
add_subdirectory("engine/kotek.core.containers.string")
add_subdirectory("engine/kotek.core.containers.hash")
add_subdirectory("engine/kotek.core.containers.deque")
add_subdirectory("engine/kotek.core.containers.dll")
add_subdirectory("engine/kotek.core.containers.filesystem")
add_subdirectory("engine/kotek.core.containers.filesystem.path")
add_subdirectory("engine/kotek.core.containers.function")
add_subdirectory("engine/kotek.core.containers.io")
add_subdirectory("engine/kotek.core.containers.json")
add_subdirectory("engine/kotek.core.containers.map")
add_subdirectory("engine/kotek.core.containers.microsoft")
add_subdirectory("engine/kotek.core.containers.microsoft.wrl.comptr")
add_subdirectory("engine/kotek.core.containers.multithreading")
add_subdirectory("engine/kotek.core.containers.multithreading.tbb")
add_subdirectory("engine/kotek.core.containers.multithreading.atomic")
add_subdirectory("engine/kotek.core.containers.multithreading.mutex")
add_subdirectory("engine/kotek.core.containers.multithreading.shared_mutex")
add_subdirectory("engine/kotek.core.containers.multithreading.thread")
add_subdirectory("engine/kotek.core.containers.multithreading.semaphore")
add_subdirectory("engine/kotek.core.containers.pair")
add_subdirectory("engine/kotek.core.containers.queue")
add_subdirectory("engine/kotek.core.containers.shared_ptr")
add_subdirectory("engine/kotek.core.containers.unique_ptr")
add_subdirectory("engine/kotek.core.containers.unordered_map")
add_subdirectory("engine/kotek.core.containers.unordered_set")
add_subdirectory("engine/kotek.core.containers.variant")
add_subdirectory("engine/kotek.core.containers.vector")
add_subdirectory("engine/kotek.core.filesystem")
add_subdirectory("engine/kotek.core.filesystem.file_text")
add_subdirectory("engine/kotek.core.format")
add_subdirectory("engine/kotek.core.memory")
add_subdirectory("engine/kotek.core.memory.cpu")
add_subdirectory("engine/kotek.core.memory.gpu")
add_subdirectory("engine/kotek.core.memory.gpu.vulkan")

if ("${KOTEK_MEMORY_LEAK_DETECTION}" STREQUAL "ON")
	if ("${KOTEK_CPP_MEMORY_LEAK_LIBRARY}" STREQUAL "VLD")
		add_subdirectory("engine/kotek.core.memory.vld")
	endif()
endif()

add_subdirectory("engine/kotek.core.math")
add_subdirectory("engine/kotek.core.profilers")
add_subdirectory("engine/kotek.core.profilers.cpu")
add_subdirectory("engine/kotek.core.profilers.gpu")
add_subdirectory("engine/kotek.core.resource_manager")
add_subdirectory("engine/kotek.core.resource_manager.loader")
add_subdirectory("engine/kotek.core.resource_manager.saver")
add_subdirectory("engine/kotek.core.os")
add_subdirectory("engine/kotek.core.os.win32")
add_subdirectory("engine/kotek.core.os.linux")
add_subdirectory("engine/kotek.core.window")
add_subdirectory("engine/kotek.core.window.glfw")
add_subdirectory("engine/kotek.core.log")
add_subdirectory("engine/kotek.core.console")
add_subdirectory("engine/kotek.core.engine_config")
add_subdirectory("engine/kotek.core.main_manager")
add_subdirectory("engine/kotek.core.ecs")
add_subdirectory("engine/kotek.core.enum")
add_subdirectory("engine/kotek.core.enum.core")
add_subdirectory("engine/kotek.core.enum.render")
add_subdirectory("engine/kotek.core.enum.render.dx")
add_subdirectory("engine/kotek.core.enum.render.gl")
add_subdirectory("engine/kotek.core.enum.render.vk")
add_subdirectory("engine/kotek.core.input")
add_subdirectory("engine/kotek.core.utility")

add_subdirectory("engine/kotek.game")

add_subdirectory("engine/kotek.ui")
add_subdirectory("engine/kotek.ui.imgui")

if (WIN32)
	# DEPRECATED: undo comments when you finish vulkan renderer!
#add_subdirectory("engine/kotek.render.dx12")
endif()

add_subdirectory("engine/kotek.render")

add_subdirectory("engine/kotek.render.shared")
add_subdirectory("engine/kotek.render.shared.vk")
add_subdirectory("engine/kotek.render.shared.gl")
add_subdirectory("engine/kotek.render.shared.dx")
add_subdirectory("engine/kotek.render.model")
add_subdirectory("engine/kotek.render.model.assimp")

add_subdirectory("engine/kotek.render.vk")
add_subdirectory("engine/kotek.render.gl3.3")
add_subdirectory("engine/kotek.render.gl.glad3.3")
add_subdirectory("engine/kotek.render.gl.glad4.6")

add_subdirectory("engine/kotek.exe")

set_property(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} PROPERTY VS_STARTUP_PROJECT kotek)